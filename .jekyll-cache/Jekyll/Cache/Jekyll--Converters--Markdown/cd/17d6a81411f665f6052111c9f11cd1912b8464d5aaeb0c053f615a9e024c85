I"è&<p><a href="https://ifallen.github.io">ç‰ˆæƒæ‰€æœ‰,è½¬è½½è¯·æ³¨æ˜å‡ºå¤„!</a></p>

<h4 id="é¡¹ç›®åœ°å€"><code class="highlighter-rouge">é¡¹ç›®åœ°å€:</code></h4>
<hr />

<p><a href="https://github.com/iFallen/HImagePickerUtils-Swift">SourceCode</a></p>

<h4 id="tips"><code class="highlighter-rouge">Tips</code></h4>

<hr />

<ul>
  <li>æ”¯æŒç…§ç‰‡é€‰å–å’Œæ‹ç…§</li>
  <li>æ”¯æŒBlockå›è°ƒ</li>
</ul>

<h4 id="ä½¿ç”¨æ–¹æ³•"><code class="highlighter-rouge">ä½¿ç”¨æ–¹æ³•:</code></h4>
<hr />
<ul>
  <li>
    <p>å®šä¹‰å…¨å±€å¸¸é‡</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  let imagePicker: HImagePickerUtils!
  //ä¸èƒ½ä¸ºä¸´æ—¶å˜é‡ï¼Œä¸´æ—¶å˜é‡é”€æ¯æ—¶ï¼ŒUIImagePickerControllerä»£ç†æ–¹æ³•ä¸ä¼šå›è°ƒ
</code></pre></div>    </div>
  </li>
  <li>
    <p>å¯¹è±¡åˆå§‹åŒ–</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  imagePicker = HImagePickerUtils()
</code></pre></div>    </div>
  </li>
  <li>
    <p>è®¾ç½®é—­åŒ…å›è°ƒ</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  imagePicker.pickPhotoEnd = {(a:UIImage?,b:HTakeStatus,c:String?) -&gt; Void in
          if b == HTakeStatus.Success {
              self.image.image = a
          }else{
              print(c)
          }
      }
</code></pre></div>    </div>
  </li>
  <li>
    <p>æ‹ä¸€å¼ </p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  imagePicker.takePhoto(self)//self is UIViewController
</code></pre></div>    </div>
  </li>
  <li>
    <p>ä»ç›¸å†Œå–</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  imagePicker.choosePhoto(self)
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="æºç "><code class="highlighter-rouge">æºç :</code></h4>
<hr />
<ul>
  <li>code</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	import UIKit
	import AVFoundation
	import AssetsLibrary
	import MobileCoreServices
	
	enum HTakeStatus{
	    case Success, Canceled, CameraDisable, PhotoLibDisable, NotImage
	}
	
	enum HPhotoType{
	    case TakePhoto, ChoosePhoto
	}
	
	typealias takeEndAction = (UIImage?,HTakeStatus,String?) -&gt; Void
	
	// HImagePickerUtils å¯¹è±¡å¿…é¡»ä¸ºå…¨å±€å˜é‡ï¼Œä¸ç„¶UIImagePickerControllerä»£ç†æ–¹æ³•ä¸ä¼šæ‰§è¡Œ
	class HImagePickerUtils: NSObject,UIImagePickerControllerDelegate,UINavigationControllerDelegate {
    
    var pickPhotoEnd: takeEndAction?
    
    func takePhoto(rootVC:UIViewController) {
        if self.isCameraAvailable() &amp;&amp; self.doesCameraSupportTakingPhotos(){
            let controller = UIImagePickerController()
            controller.view.backgroundColor = UIColor.whiteColor()
            controller.sourceType = UIImagePickerControllerSourceType.Camera
            controller.mediaTypes = [kUTTypeImage as String]
            controller.allowsEditing = true
            controller.delegate = self
            
            let sysVersion = (UIDevice.currentDevice().systemVersion as NSString).floatValue
            if sysVersion &gt;= 8.0{
                controller.modalPresentationStyle = UIModalPresentationStyle.OverCurrentContext
            }
            
            if !self.isAuthorized(){
                if sysVersion &gt;= 8.0 {
                    let alertVC = UIAlertController(title: nil, message: "æ‚¨é˜»æ­¢äº†ç›¸æœºè®¿é—®æƒé™", preferredStyle: UIAlertControllerStyle.Alert)
                    let openIt = UIAlertAction(title: "é©¬ä¸Šæ‰“å¼€", style: UIAlertActionStyle.Default, handler: { (alert:UIAlertAction) -&gt; Void in
                        UIApplication.sharedApplication().openURL(NSURL(string: UIApplicationOpenSettingsURLString)!)
                    })
                    alertVC.addAction(openIt)
                    rootVC.presentViewController(alertVC, animated: true, completion: nil)
                }else{
                    let alertVC = UIAlertController(title: "æç¤º", message: "è¯·åœ¨ 'ç³»ç»Ÿè®¾ç½®|éšç§|ç›¸æœº|å…¨åŸçƒ­éº¦' ä¸­å¼€å¯ç›¸æœºè®¿é—®æƒé™", preferredStyle: UIAlertControllerStyle.Alert)
                    rootVC.presentViewController(alertVC, animated: true, completion: nil)
                }
            }else{
                rootVC.presentViewController(controller, animated: true, completion: nil)
            }
        }else{
            if (self.pickPhotoEnd != nil){
                self.pickPhotoEnd?(nil,HTakeStatus.CameraDisable,"è¯¥è®¾å¤‡ä¸æ”¯æŒæ‹ç…§")
            }
        }
    }
    
    func choosePhoto(rootVC:UIViewController){
        if self.isPhotoLibraryAvailable(){
            let controller = UIImagePickerController()
            controller.view.backgroundColor = UIColor.whiteColor()
            controller.sourceType = UIImagePickerControllerSourceType.PhotoLibrary
            var mediaTypes = [String]()
            if self.canUserPickPhotosFromPhotoLibrary(){
                mediaTypes.append(kUTTypeImage as String)
            }
            controller.allowsEditing = true
            controller.mediaTypes = mediaTypes
            if (UIDevice.currentDevice().systemVersion as NSString).floatValue &gt;= 8.0{
                controller.modalPresentationStyle = UIModalPresentationStyle.OverCurrentContext
            }
            controller.delegate = self
            rootVC.presentViewController(controller, animated: true, completion: nil)
        }else{
            if self.pickPhotoEnd != nil{
                self.pickPhotoEnd?(nil,HTakeStatus.PhotoLibDisable,"è¯¥è®¾å¤‡ä¸æ”¯æŒèµ„æºé€‰æ‹©")
            }
        }
    }
    
    //MARK: UIImagePickerControllerDelegate
    func imagePickerController(picker: UIImagePickerController, didFinishPickingMediaWithInfo info: [String : AnyObject]) {
        let mediaType = info[UIImagePickerControllerMediaType] as! NSString
        if mediaType.isEqualToString(kUTTypeImage as String) {
            let theImage : UIImage!
            if picker.allowsEditing{
                theImage = info[UIImagePickerControllerEditedImage] as! UIImage
            }else{
                theImage = info[UIImagePickerControllerOriginalImage] as! UIImage
            }
            if self.pickPhotoEnd != nil {
                self.pickPhotoEnd?(theImage,HTakeStatus.Success,nil)
            }
        }else{
            if self.pickPhotoEnd != nil {
                self.pickPhotoEnd?(nil,HTakeStatus.NotImage,"è·å–çš„ä¸æ˜¯å›¾ç‰‡")
            }
        }
        picker.dismissViewControllerAnimated(true, completion: nil)
    }
    
    func imagePickerControllerDidCancel(picker: UIImagePickerController) {
        picker.dismissViewControllerAnimated(true) { () -&gt; Void in
            if self.pickPhotoEnd != nil {
                self.pickPhotoEnd?(nil,HTakeStatus.Canceled,"å–æ¶ˆé€‰æ‹©")
            }
        }
    }
    
    //MARK: ç”¨æˆ·æ˜¯å¦æˆæƒ
    func isAuthorized() -&gt; Bool{
        let mediaType = AVMediaTypeVideo
        let authStatus = AVCaptureDevice.authorizationStatusForMediaType(mediaType)
        if authStatus == AVAuthorizationStatus.Restricted ||
            authStatus == AVAuthorizationStatus.Denied{
                return false
        }
        return true
    }
    
    //MARK: ç›¸æœºåŠŸèƒ½æ˜¯å¦å¯ç”¨
    func isCameraAvailable() -&gt; Bool{
        return UIImagePickerController.isSourceTypeAvailable(UIImagePickerControllerSourceType.Camera)
    }
    
    //MARK: å‰ç½®æ‘„åƒå¤´æ˜¯å¦å¯ç”¨
    func isFrontCameraAvailable() -&gt; Bool{
        return UIImagePickerController.isCameraDeviceAvailable(UIImagePickerControllerCameraDevice.Front)
    }
    
    //MARK: åç½®æ‘„åƒå¤´æ˜¯å¦å¯ç”¨
    func isRearCameraAvailable() -&gt; Bool{
        return UIImagePickerController.isCameraDeviceAvailable(UIImagePickerControllerCameraDevice.Rear)
    }
    
    //MARK: åˆ¤æ–­æ˜¯å¦æ”¯æŒæŸç§å¤šåª’ä½“ç±»å‹ï¼šæ‹ç…§ï¼Œè§†é¢‘
    func cameraSupportsMedia(paramMediaType:NSString, sourceType:UIImagePickerControllerSourceType) -&gt; Bool {
        var result = false
        if paramMediaType.length == 0 {
            return false
        }
        let availableMediaTypes = NSArray(array: UIImagePickerController.availableMediaTypesForSourceType(sourceType)!)
        availableMediaTypes.enumerateObjectsUsingBlock { (obj:AnyObject, idx:NSInteger, stop:UnsafeMutablePointer&lt;ObjCBool&gt;) -&gt; Void in
            let type = obj as! NSString
            if type.isEqualToString(paramMediaType as String) {
                result = true
                stop.memory = true
            }
        }
        return result
    }
    
    //MARK: æ£€æŸ¥æ‘„åƒå¤´æ˜¯å¦æ”¯æŒå½•åƒ
    func doesCameraSupportShootingVides() -&gt; Bool{
        return self.cameraSupportsMedia(kUTTypeMovie, sourceType: UIImagePickerControllerSourceType.Camera)
    }
    //MARK: æ£€æŸ¥æ‘„åƒå¤´æ˜¯å¦æ”¯æŒæ‹ç…§
    func doesCameraSupportTakingPhotos() -&gt; Bool{
        return self.cameraSupportsMedia(kUTTypeImage, sourceType: UIImagePickerControllerSourceType.Camera)
    }
    
    //MARK: ç›¸å†Œæ˜¯å¦å¯ç”¨
    func isPhotoLibraryAvailable() -&gt; Bool {
        return UIImagePickerController.isSourceTypeAvailable(UIImagePickerControllerSourceType.PhotoLibrary)
    }
    
    //MARK: æ˜¯å¦å¯åœ¨ç›¸å†Œä¸­é€‰æ‹©è§†é¢‘
    func canUserPickVideosFromPhotoLibrary() -&gt; Bool {
        return self.cameraSupportsMedia(kUTTypeMovie, sourceType: UIImagePickerControllerSourceType.PhotoLibrary)
    }
    
    //MARK: æ˜¯å¦å¯åœ¨ç›¸å†Œä¸­é€‰æ‹©å›¾ç‰‡
    func canUserPickPhotosFromPhotoLibrary() -&gt; Bool {
        return self.cameraSupportsMedia(kUTTypeImage, sourceType: UIImagePickerControllerSourceType.PhotoLibrary)
    }
	}

</code></pre></div></div>

<h4 id="æ•ˆæœå›¾"><code class="highlighter-rouge">æ•ˆæœå›¾</code></h4>
<hr />
<p><br />
<img src="https://github.com/iFallen/HImagePickerUtils-Swift/raw/master/ScreenShots/screenShot.png" alt="" /></p>
:ET